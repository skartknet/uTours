@using System.Text.Json
@using UTours.Core.ViewComponents
@using Umbraco.Cms.Web.Common.PublishedModels

@model IEnumerable<UToursTour>

@{

    var firstTour = Model.FirstOrDefault();

    if (firstTour == null)
    {
        return;
    }

    var jso = new JsonSerializerOptions(JsonSerializerDefaults.Web)
            {
                PropertyNamingPolicy = JsonNamingPolicy.CamelCase,
                WriteIndented = true
            };

    var options = JsonSerializer.Serialize(firstTour, jso);

    var steps = firstTour.Steps is null ? "[]" :
                    JsonSerializer.Serialize(firstTour.Steps.Select(x=>x.Content as UToursTourStep), jso);
}


<script>
    var tourOptions = @Html.Raw(options);
    tourOptions.steps = @Html.Raw(steps);

    const tg = new tourguide.TourGuideClient(tourOptions);
    tg.addSteps(tourSteps);
    tg.start();

</script>